<h1 class="fr-mt-6w">
  <%= pageTitle %>
</h1>

<% if (singleLocation?.code) { %>
<div class="fr-grid-row">
  <div class="fr-col-12 fr-col-md-3">
    <p>
      SIREN : <%= singleLocation.code %>
    </p>
    <p>
      Population : <%= formatNumber(singleLocation.populationTotale) %>
    </p>
  </div>
  <div class="fr-col" style="text-align: right;">
    <p class="fr-mb-1w">
      <a href="<%= getTabUrl('tableur') %><%= sharingQueryStr %> " download class="fr-btn fr-btn--secondary">Télécharger en format Excel</a>
    </p>
    <p class="fr-text--sm fr-sm-mb-0">
      <a href="https://docs.datagir.ademe.fr/documentation-aldo/" target="_blank" rel="noopener noreferrer">
        Documentation
      </a>
    </p>
  </div>
</div>

<% if (singleLocation?.membres.length) { %>
<section class="fr-accordion">
  <p class="fr-accordion__title">
    <button class="fr-accordion__btn" aria-expanded="false" aria-controls="accordion-communes">
      <%= singleLocation.membres.length %> communes
    </button>
  </p>
  <div class="fr-collapse" id="accordion-communes">
    <ul>
      <div class="fr-grid-row">
        <% for( let index=0; index < singleLocation.membres.length; index++ ) { %>
        <div class="fr-col-12 fr-sm-col-6 fr-col-md-4">
          <li>
            <%= singleLocation.membres[index] %>
          </li>
        </div>
        <% } %>
      </div>
    </ul>
  </div>
</section>
<% } else { %>
<p>
  <%= singleLocation.nombreCommunes %> commune<%= singleLocation.nombreCommunes === 1 ? '' : 's' %>
</p>
<% } %>
<% } else if (singleLocation?.insee) { %>
<div class="fr-grid-row">
  <div class="fr-col-12 fr-col-md-3">
    <p>
      INSEE : <%= singleLocation.insee %>
    </p>
    <p>
      Population : <%= formatNumber(singleLocation.POPULATION) %>
    </p>
    <p>
      SIREN EPCI : <a href="/epci/<%= singleLocation.epci %>"><%= singleLocation.epci %></a>
    </p>
  </div>
  <div class="fr-col" style="text-align: right;">
    <p class="fr-mb-1w">
      <a href="<%= getTabUrl('tableur') %><%= sharingQueryStr %> " download class="fr-btn fr-btn--secondary">Télécharger en format Excel</a>
    </p>
    <p class="fr-text--sm fr-sm-mb-0">
      <a href="https://docs.datagir.ademe.fr/documentation-aldo/" target="_blank" rel="noopener noreferrer">
        Documentation
      </a>
    </p>
  </div>
</div>
<% } %>

<% if (epcis && epcis.length) { %>
<p class="fr-mb-0">EPCI :</p>
<ul>
  <% for( let index=0; index < epcis.length; index++ ) { %>
    <li>
      <%= epcis[index].nom %> (<%= epcis[index].code %>)
    </li>
  <% } %>
</ul>
<% } %>
<% if (communes && communes.length) { %>
<p class="fr-mb-0">Commune :</p>
<ul>
  <% for( let index=0; index < communes.length; index++ ) { %>
    <li>
      <%= communes[index].nom %> (<%= communes[index].insee %>)
    </li>
  <% } %>
</ul>
<% } %>

<div class="fr-callout fr-my-3w">
  <p class="fr-callout__title fr-mb-1w">
    Une <%= fluxTotal > 0 ? "séquestration" : "émission" %>
    nette de carbone de
    <%= formatNumber(Math.abs(fluxTotal)/1000, 1) %> ktCO<sub>2</sub>e / an
    et un stock total de
    <%= formatNumber(stockTotal/1000000, 1) %> MtC,
    à préserver&nbsp;!
  </p>
  <p class="fr-callout__text fr-mb-1w">
    Si tout ce stock de carbone était réémis vers l'atmosphère, cela représenterait une émission de
    <%= formatNumber(stockTotalEquivalent/1000) %> ktCO2e.
    À ce jour, il y a une <%= fluxTotal > 0 ? "augmentation" : "réduction" %> de
    <%= formatNumber(Math.abs(fluxTotal)/stockTotal * 100, 1) %> % du stock par an.
  </p>
  <% if (beges) { %>
  <p>
    À titre de comparaison, ce flux de carbone
    <%= fluxTotal > 0 ? "séquetre" : "émet" %>
    <%= formatNumber(fluxTotal/beges * 100) %> % du BEGES<%= perimetre ? ` ${perimetre}` : '' %>,
    donc de ce qui est émit chaque année par le territoire.
  </p>
  <% } else { %>
  <p class="fr-text--xs">
    Ajoutez le Bilan GES de Territoire dans <a href="<%= getTabUrl('configuration') %><%= sharingQueryStr %> ">l'onglet configuration</a>.
  </p>
  <% } %>
</div>